# 主要功能
word——排版+标题序号编排
## 1.序号编排
按照论文写作规范，根据【大纲级别】自动写入每个标题的序号，效果如图。
![image](https://github.com/XStir/word--Type-setting-and-Title-index/blob/master/example.png)
## 2.排版
原理为每一段话套用特定的样式，而样式的具体设定可以自行更改，从而达到排版效果。

# 使用方法
## 1
对于准备运用这段代码的word文档（以下简称文档），应先确保具有对应的样式。
我已经上传了一份做好了样式的模板文档，可以下载后将样式全部导入；也可以自己创建样式。

目前必须具备的样式有：【一级、二级、三级、四级、五级、六级及以下、图表标题、正文、居中正文、单张图片、表内文字】

程序以样式名字来识别与分配样式。

## 2
使光标位于文档中希望程序开始执行的地点，例如光标位于第9个段落中，那么程序作用范围为第9段至文档结尾，而不影响1~8段。这个设计目的是方便在一些有封面和目录的文档中使用，如图：

另外，如果光标选择了一段字符串（涂黑选中），那么程序将忽略这个设定，总是从第一段开始执行，即作用范围为整个文档。

## 3
打开VBE界面，复制全部代码到VBE中，按需求修改用户自定义部分（位于代码头部）。

运行Main()程序（光标位于该段代码内，点击运行或F5运行）。

## 4
耐心等待程序运行完成。顺利完成会出现“完成”的提示框，如果检测到大纲级别错误，程序会抛出错误的提示框，并终止在错误发生的段落处。

# 原理概要
逐段执行下列判断：
## (1)
如果本段落目前的样式为指定的"例外样式"，则跳过本段。

注：例外样式在程序头部自定义，将希望设定为例外的样式名字写入到'ExsistTypeName'变量中。
## (2)
删除段落前指定的字符（在程序头部自定义）
## (3)
如果段落带大纲级别，则写入相应的标题序号
## (4)
根据段落情况与程序设定为段落分配样式
## (5)
对每一个表格依次进行修改操作

# 注意事项
## 大纲级别
运行此程序前需要确保大纲级别已经设置正确。对于不具有大纲级别的段落（大纲级别=0级），会依据用户设定套用正文、正文居中、图片、图表标题或其他自定义样式。

## 样式
样式类别最好为【链接段落和字符】；【段落】也勉强可以用，但是对于段落中有不同样式设定的情况可能会出bug。
![image](https://github.com/XStir/word--Type-setting-and-Title-index/blob/master/%E6%A0%B7%E5%BC%8F%E7%B1%BB%E5%9E%8B.jpg)
样式库中要有对应的样式（见2.1），并且名字与程序中指定的一致。样式名字不是固定的，它只是一个代号，可以改；记得同时在代码和样式库中修改。

## 图片
想要纳入程序作用范围的图片必须为嵌入型（InlineShapes），其他类型的图片会被忽略。

# 目前进度与下步计划（有生之年→_→）
更新日期：2019年4月
## 目前未用样式
这些样式虽然已经写在程序头部的自定义中了，但是现在还没用到，不创建也没关系：

【表头、表题、图题】
## 区分图题和表题
目前，图题和表题是共用一个样式的，并且不支持编排序号。

初步计划为写一段单独的代码，将图题和表题分开，并为每一个图题、表题编排和写入序号；序号形式可以自定义，如：【图 n】、【图3.2-5】等形式。

这段代码专门识别样式为【图表标题】的段落，然后再具体进行辨认是图题还是表题并分配样式与编号。因此它应该在执行完本代码后再运行，或者在本代码运行后自动运行。

## 图片
还没考虑多图片的段落、同一行现实多个图片的情况。现在默认所有图片都是单独为一段，设为居中（样式为“单张图片”）

## 表格
现在对于每一个表格，仅仅是选中全部表格，然后统一套用“表内文字”样式

## 错误检测
目前只有一类错误检测：大纲级别错误。例如本段落大纲为5级，而上一级为3级，则报错（缺少中间层级）

# 与其他程序配合使用
都是些小功能。
待会发。
